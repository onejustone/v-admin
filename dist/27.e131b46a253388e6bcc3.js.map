{"version":3,"sources":["webpack:///27.e131b46a253388e6bcc3.js","webpack:///asserts/apps/web/src/views/rxjs/demos/SimpleDrag.vue","webpack:///./asserts/apps/web/src/views/rxjs/demos/SimpleDrag.vue?055b","webpack:///./asserts/apps/web/src/views/rxjs/demos/SimpleDrag.vue"],"names":["webpackJsonp","1182","module","__webpack_exports__","__webpack_require__","__WEBPACK_IMPORTED_MODULE_0_rxjs__","name","domStreams","data","computed","dragContainerWrapper","this","$el","dragContainer","querySelectorAll","dragCellElement","watchAsObservable","subscriptions","_this","rootScroll$","dragContainerWrapperScroll$","map","e","getBoundingClientRect","y","bool","classList","add","remove","mouseDown$","$fromDOMEvent","filter","contains","mouseMove$","containerMouseMove$","throttleTime","_ref","event","mouseUp$","mouseout$","stopDrag$","merge","criticalValue","_ref2","value","min","max","Math","dragSteam$","takeUntil","concatAll","withLatestFrom","move","down","wrapperRect","minY","top","maxY","bottom","height","minX","left","maxX","right","width","relativeY","clientY","offsetY","relativeX","clientX","offsetX","safeX","safeY","style","1311","exports","1312","render","_vm","_h","$createElement","_c","_self","directives","rawName","expression","arg","staticClass","staticRenderFns","esExports","925","injectStyle","ssrContext","Object","defineProperty","__WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_13_7_3_vue_loader_lib_selector_type_script_index_0_SimpleDrag_vue__","__WEBPACK_IMPORTED_MODULE_1__node_modules_vue_loader_13_7_3_vue_loader_lib_template_compiler_index_id_data_v_139b67b2_hasScoped_true_buble_transforms_node_modules_vue_loader_13_7_3_vue_loader_lib_template_compiler_preprocessor_engine_pug_node_modules_vue_loader_13_7_3_vue_loader_lib_selector_type_template_index_0_SimpleDrag_vue__","normalizeComponent","__vue_styles__","Component"],"mappings":"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","file":"27.e131b46a253388e6bcc3.js","sourcesContent":["webpackJsonp([27],{\n\n/***/ 1182:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_rxjs__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_rxjs_operators__ = __webpack_require__(3);\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\n\n\n\n/* harmony default export */ __webpack_exports__[\"a\"] = ({\n  name: 'RxDrag',\n\n  domStreams: ['dragContainerWrapperScroll$', 'containerMouseMove$'],\n\n  data: function data() {\n    return {};\n  },\n\n\n  computed: {\n    dragContainerWrapper: function dragContainerWrapper() {\n      return this.$el || null;\n    },\n    dragContainer: function dragContainer() {\n      if (this.$el) {\n        return this.$el.querySelectorAll('.drag-container')[0];\n      }\n\n      return null;\n    },\n    dragCellElement: function dragCellElement() {\n      if (this.$el) {\n        return this.$el.querySelectorAll('.drag-cell')[0];\n      }\n\n      return null;\n    }\n  },\n\n  watchAsObservable: function watchAsObservable() {},\n  subscriptions: function subscriptions() {\n    var _this = this;\n\n    var rootScroll$ = this.dragContainerWrapperScroll$.map(function (e) {\n      return _this.dragContainer.getBoundingClientRect().y < 0;\n    }).map(function (bool) {\n      return bool ? _this.dragCellElement.classList.add('drag-cell__fixed') : _this.dragCellElement.classList.remove('drag-cell__fixed');\n    });\n\n    var mouseDown$ = this.$fromDOMEvent('.drag-cell', 'mousedown')\n    // 用 filter 判断下，如果当前 dragCell 没有 fixed 的话，则事件不发出\n    .filter(function (e) {\n      return _this.dragCellElement.classList.contains('drag-cell__fixed');\n    });\n\n    var mouseMove$ = this.containerMouseMove$.throttleTime(30).map(function (_ref) {\n      var data = _ref.data,\n          event = _ref.event;\n      return event;\n    });\n\n    var mouseUp$ = this.$fromDOMEvent('.drag-cell', 'mouseup');\n    //. mouseout冒泡 mouseleave不冒泡\n    var mouseout$ = this.$fromDOMEvent(null, 'mouseout');\n\n    var stopDrag$ = __WEBPACK_IMPORTED_MODULE_0_rxjs__[\"Observable\"].merge(mouseUp$, mouseout$);\n\n    var criticalValue = function criticalValue(_ref2) {\n      var value = _ref2.value,\n          min = _ref2.min,\n          max = _ref2.max;\n\n      return Math.min(Math.max(min, value), max);\n    };\n\n    var dragSteam$ = mouseDown$.map(function (e) {\n      return mouseMove$.takeUntil(stopDrag$);\n    }).concatAll().withLatestFrom(mouseDown$, function (move, down) {\n      var wrapperRect = _this.dragContainerWrapper.getBoundingClientRect();\n      var dragCellElement = _this.dragCellElement.getBoundingClientRect();\n\n      var minY = wrapperRect.top;\n      var maxY = wrapperRect.bottom - dragCellElement.height;\n\n      var minX = wrapperRect.left;\n      var maxX = wrapperRect.right - dragCellElement.width;\n\n      var relativeY = move.clientY - down.offsetY;\n      var relativeX = move.clientX - down.offsetX;\n\n      var safeX = criticalValue({ value: relativeX, min: minX, max: maxX });\n      var safeY = criticalValue({ value: relativeY, min: minY, max: maxY });\n\n      _this.dragCellElement.style.top = safeY + 'px';\n      _this.dragCellElement.style.left = safeX + 'px';\n    });\n\n    return {\n      rootScroll$: rootScroll$,\n      dragSteam$: dragSteam$\n    };\n  }\n});\n\n/***/ }),\n\n/***/ 1311:\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ }),\n\n/***/ 1312:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nvar render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('section',{directives:[{name:\"stream\",rawName:\"v-stream:scroll\",value:(_vm.dragContainerWrapperScroll$),expression:\"dragContainerWrapperScroll$\",arg:\"scroll\"}],staticClass:\"drag-container-wrapper\"},[_c('section',{directives:[{name:\"stream\",rawName:\"v-stream:mousemove\",value:(_vm.containerMouseMove$),expression:\"containerMouseMove$\",arg:\"mousemove\"}],staticClass:\"drag-container\"},[_c('div',{staticClass:\"drag-cell\"})])])}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\n/* harmony default export */ __webpack_exports__[\"a\"] = (esExports);\n\n/***/ }),\n\n/***/ 925:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_13_7_3_vue_loader_lib_selector_type_script_index_0_SimpleDrag_vue__ = __webpack_require__(1182);\n/* empty harmony namespace reexport */\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__node_modules_vue_loader_13_7_3_vue_loader_lib_template_compiler_index_id_data_v_139b67b2_hasScoped_true_buble_transforms_node_modules_vue_loader_13_7_3_vue_loader_lib_template_compiler_preprocessor_engine_pug_node_modules_vue_loader_13_7_3_vue_loader_lib_selector_type_template_index_0_SimpleDrag_vue__ = __webpack_require__(1312);\nfunction injectStyle (ssrContext) {\n  __webpack_require__(1311)\n}\nvar normalizeComponent = __webpack_require__(22)\n/* script */\n\n\n/* template */\n\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-139b67b2\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_13_7_3_vue_loader_lib_selector_type_script_index_0_SimpleDrag_vue__[\"a\" /* default */],\n  __WEBPACK_IMPORTED_MODULE_1__node_modules_vue_loader_13_7_3_vue_loader_lib_template_compiler_index_id_data_v_139b67b2_hasScoped_true_buble_transforms_node_modules_vue_loader_13_7_3_vue_loader_lib_template_compiler_preprocessor_engine_pug_node_modules_vue_loader_13_7_3_vue_loader_lib_selector_type_template_index_0_SimpleDrag_vue__[\"a\" /* default */],\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\n/* harmony default export */ __webpack_exports__[\"default\"] = (Component.exports);\n\n\n/***/ })\n\n});\n\n\n// WEBPACK FOOTER //\n// 27.e131b46a253388e6bcc3.js","<template lang=\"pug\">\n  section.drag-container-wrapper(\n    v-stream:scroll=\"dragContainerWrapperScroll$\"\n  )\n    section.drag-container(\n      v-stream:mousemove=\"containerMouseMove$\"\n    )\n      div.drag-cell\n</template>\n\n<script>\n  import { Observable } from 'rxjs'\n  import { pluck } from 'rxjs/operators'\n\n  export default {\n    name: 'RxDrag',\n\n    domStreams: [\n      'dragContainerWrapperScroll$',\n      'containerMouseMove$'\n     ],\n\n    data () {\n      return {\n      }\n    },\n\n    computed: {\n      dragContainerWrapper () {\n        return this.$el || null\n      },\n\n      dragContainer () {\n         if (this.$el) {\n          return this.$el.querySelectorAll('.drag-container')[0]\n        }\n\n        return null\n      },\n\n      dragCellElement () {\n        if (this.$el) {\n          return this.$el.querySelectorAll('.drag-cell')[0]\n        }\n\n        return null\n      }\n    },\n\n    watchAsObservable () {\n    },\n\n    subscriptions () {\n      const rootScroll$ = this.dragContainerWrapperScroll$\n        .map(e => this.dragContainer.getBoundingClientRect().y < 0)\n        .map(bool => bool ?\n            this.dragCellElement.classList.add('drag-cell__fixed') :\n            this.dragCellElement.classList.remove('drag-cell__fixed')\n        )\n\n      const mouseDown$ = this.$fromDOMEvent('.drag-cell', 'mousedown')\n        // 用 filter 判断下，如果当前 dragCell 没有 fixed 的话，则事件不发出\n        .filter(e => this.dragCellElement.classList.contains('drag-cell__fixed'))\n\n      const mouseMove$ = this.containerMouseMove$\n        .throttleTime(30)\n        .map(({ data, event }) => event )\n\n      const mouseUp$ = this.$fromDOMEvent('.drag-cell', 'mouseup')\n      //. mouseout冒泡 mouseleave不冒泡\n      const mouseout$ = this.$fromDOMEvent(null, 'mouseout')\n\n      const stopDrag$ = Observable.merge(mouseUp$, mouseout$)\n\n      const criticalValue = ({ value, min, max }) => {\n        return Math.min(Math.max(min, value), max)\n      }\n\n      const dragSteam$ = mouseDown$.map(e => mouseMove$.takeUntil(stopDrag$))\n        .concatAll()\n        .withLatestFrom(mouseDown$, (move, down) => {\n          const wrapperRect = this.dragContainerWrapper.getBoundingClientRect()\n          const dragCellElement = this.dragCellElement.getBoundingClientRect()\n\n          const minY = wrapperRect.top\n          const maxY = wrapperRect.bottom - dragCellElement.height\n\n          const minX = wrapperRect.left\n          const maxX = wrapperRect.right - dragCellElement.width\n\n          const relativeY = move.clientY - down.offsetY\n          const relativeX = move.clientX - down.offsetX\n\n          const safeX = criticalValue({ value: relativeX, min: minX, max: maxX })\n          const safeY = criticalValue({ value: relativeY, min: minY, max: maxY })\n\n          this.dragCellElement.style.top = `${safeY}px`\n          this.dragCellElement.style.left = `${safeX}px`\n        })\n\n      return {\n        rootScroll$,\n        dragSteam$\n      }\n    }\n  }\n</script>\n\n<style lang=\"stylus\" scoped>\n.drag-container-wrapper\n  height: 600px;\n  border: 1px solid green;\n  overflow-y: scroll;\n  padding: 10px;\n\n.drag-container\n  border: 1px solid red;\n  height: 1600px;\n\n.drag-cell\n  width 50px\n  height 50px\n  border 1px solid pink\n  background-color #eee\n  border-radius 50%\n  &:hover\n    cursor move\n    box-shadow 0px 0px 4px 1px pink\n\n.drag-cell__fixed\n  position fixed\n  right 20px\n  top 100px\n  z-index 99\n  transition all 0.2\n</style>\n\n\n\n\n// WEBPACK FOOTER //\n// asserts/apps/web/src/views/rxjs/demos/SimpleDrag.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('section',{directives:[{name:\"stream\",rawName:\"v-stream:scroll\",value:(_vm.dragContainerWrapperScroll$),expression:\"dragContainerWrapperScroll$\",arg:\"scroll\"}],staticClass:\"drag-container-wrapper\"},[_c('section',{directives:[{name:\"stream\",rawName:\"v-stream:mousemove\",value:(_vm.containerMouseMove$),expression:\"containerMouseMove$\",arg:\"mousemove\"}],staticClass:\"drag-container\"},[_c('div',{staticClass:\"drag-cell\"})])])}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/_vue-loader@13.7.3@vue-loader/lib/template-compiler?{\"id\":\"data-v-139b67b2\",\"hasScoped\":true,\"buble\":{\"transforms\":{}}}!./node_modules/_vue-loader@13.7.3@vue-loader/lib/template-compiler/preprocessor.js?engine=pug!./node_modules/_vue-loader@13.7.3@vue-loader/lib/selector.js?type=template&index=0!./asserts/apps/web/src/views/rxjs/demos/SimpleDrag.vue\n// module id = 1312\n// module chunks = 27","function injectStyle (ssrContext) {\n  require(\"!!../../../../../../../node_modules/_extract-text-webpack-plugin@3.0.2@extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":0,\\\"remove\\\":true,\\\"allChunks\\\":true,\\\"filename\\\":\\\"css/[name].[contenthash].css\\\"}!css-loader!../../../../../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-139b67b2\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!postcss-loader!stylus-loader!../../../../../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=styles&index=0!./SimpleDrag.vue\")\n}\nvar normalizeComponent = require(\"!../../../../../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../../../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=script&index=0!./SimpleDrag.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../../../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=script&index=0!./SimpleDrag.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../../../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-139b67b2\\\",\\\"hasScoped\\\":true,\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../../../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/template-compiler/preprocessor?engine=pug!../../../../../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=template&index=0!./SimpleDrag.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-139b67b2\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./asserts/apps/web/src/views/rxjs/demos/SimpleDrag.vue\n// module id = 925\n// module chunks = 27"],"sourceRoot":""}